{% extends 'base.html' %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('static', filename='style/project_form.css') }}?v=1">
{% endblock head %}


{% block title %}Overview: {{ project}}{% endblock title %}


{% block large_navigation %}
    <a class="mdl-navigation__link" href="">Link</a>
{% endblock large_navigation %}


{% block side_navigation %}
    <a class="mdl-navigation__link" href="">Link</a>
{% endblock side_navigation %}

{% block content %}
    <div class="mdl-grid">
        <div class="mdl-cell mdl-cell--4-col">
            <form id="nameForm" method="post" >
                <div class="form-group">
                    <label for="project_name">Project Name:</label>
                    <input class="mdl-js-textfield" type="text" id="project_name" value="{{ project.name if project.name else ''}}" name="project_name" onchange="sendNameForm()">
                </div>
                <input type="hidden" name="action" value="name_edit"><!-- zur Identifizierung des POSTs  -->
            </form>
            <div class="form-group">
                <label for="og_file">Original File:</label>
                <a href="{{ url_for('data', filename=project.ascii_file) }}">Open</a>
            </div>
            <div class="form-group">
                <label for="information_csv">Information CSV:</label>
                {% if project.info_csv %}
                <a href="{{ url_for('data', filename=project.info_csv) }}">Download CSV</a>
                {% else %}
                    <b>-</b>
                {% endif %}
            </div>
            <div class="form-group">
                <label for="measurements_csv">Measurement CSV:</label>
                {% if project.measurements_csv %}
                    <a href="{{ url_for('data', filename=project.measurements_csv) }}">Download CSV</a>
                {% else %}
                    <b>-</b>
                {% endif %}
            </div>
            <div class="form-group">
                <label>Peaks CSV:</label>
                {% if project.peaks_csv %}
                    <a href="{{ url_for('data', filename=project.peaks_csv) }}">Download CSV</a>
                {% else %}
                    <b>-</b>
                {% endif %}
            </div>
            <div class="form-group">
                <label for="date">Date:</label>
                <input class="mdl-js-textfield" type="text" id="date" value="{{ project.date.strftime('%d.%m.%Y %H:%M') if project.date else '' }}" name="project_date" disabled>
            </div>

            <hr> <!-- Hier wird die Trennlinie eingefügt -->
            <div class="mdl-grid" style="padding-left: 0;">
                 <form id="generatePeaksForm" method="post" >
                     {% if project.peaks_csv %}
                         <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" onclick="sendGeneratePeaksForm()">Generate Peaks</button>
                     {% else %}
                         <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" type="submit">Generate Peaks</button>
                     {% endif %}
                     <input type="hidden" name="action" value="generate_peaks"><!-- zur Identifizierung des POSTs  -->
                 </form>
            </div>
            <div class="mdl-grid" style="padding-left: 0;">
                 <form id="deleteForm" method="post" >
                     <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" style="background: darkred;" onclick="sendDeleteForm()">Delete Project</button>
                     <input type="hidden" name="action" value="delete_project"><!-- zur Identifizierung des POSTs  -->
                 </form>
            </div>
        </div>
    </div>

    <script>

    function sendNameForm() {
        let form = document.getElementById('nameForm');
        form.submit();
    }

      function sendGeneratePeaksForm() {
         if (confirm('Are you sure you want to generate new Peaks! This will overwrite your changes!')) {
             document.getElementById('generatePeaksForm').submit();
         }
    }

    function sendDeleteForm() {
        if (confirm('Are you sure you want to delete this project?')) {
        // Wenn der Benutzer bestätigt, senden Sie das Formular
        document.getElementById('deleteForm').submit();
        }
    }

    </script>
{% endblock content %}






